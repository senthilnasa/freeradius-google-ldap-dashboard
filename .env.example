# =================================================================================
# FreeRADIUS Google LDAP Configuration - EXAMPLE TEMPLATE
# =================================================================================
# Copy this file to .env and update with your actual values
# cp .env.example .env
# Required: Google Workspace with Secure LDAP enabled

# =================================================================================
# NETWORK CONFIGURATION
# =================================================================================
# Network range allowed to access FreeRADIUS server (usually your Access Points)
ACCESS_ALLOWED_CIDR=10.10.0.0/16

# RADIUS shared secret (CHANGE THIS!)
SHARED_SECRET=your_radius_shared_secret

# =================================================================================
# GOOGLE LDAP CONFIGURATION
# =================================================================================
# Primary domain for Google Workspace
# For single domain: yourdomain.com → BASE_DOMAIN=yourdomain, DOMAIN_EXTENSION=com
# For multi-level domain: yourdomain.co.uk → BASE_DOMAIN=yourdomain, DOMAIN_EXTENSION=co.uk
BASE_DOMAIN=yourdomain
DOMAIN_EXTENSION=com

# Google LDAP certificate paths (these point to mounted cert files)
GOOGLE_LDAPTLS_CERT=/etc/freeradius/certs/ldap-client.crt
GOOGLE_LDAPTLS_KEY=/etc/freeradius/certs/ldap-client.key

# Google LDAP server (standard for all Google Workspace)
LDAP_SERVER=ldaps://ldap.google.com:636

# Google LDAP service account credentials (from Google Admin Console)
LDAP_IDENTITY=your_ldap_service_account_username
LDAP_PASSWORD=your_ldap_service_account_password

# LDAP search base DN and bind DN
# IMPORTANT: For multiple domains in Google Workspace
# - Google Workspace LDAP uses the primary domain as root
# - With scope='sub' in LDAP config, searches across ALL domains in the workspace
# - All configured domains in DOMAIN_CONFIG will be searchable
# Examples:
#   Single domain (example.com): dc=example,dc=com
#   Multi-level domain (example.co.uk): dc=example,dc=co,dc=uk
LDAP_BASE_DN=dc=yourdomain,dc=com
LDAP_BIND_DN=dc=yourdomain,dc=com

# =================================================================================
# DATABASE CONFIGURATION
# =================================================================================
# MySQL database settings
DB_HOST=mysql
DB_PORT=3306
DB_NAME=radius
DB_USER=radius
DB_PASSWORD=YourSecureDatabasePassword123!
DB_ROOT_PASSWORD=YourSecureRootPassword123!

# Database performance settings
DB_MAX_CONNECTIONS=150
ENABLE_SQL_TRACE=false

# MySQL timezone setting (examples: UTC, Asia/Kolkata, America/New_York, Europe/London)
MYSQL_TIMEZONE=Asia/Kolkata

# MySQL timezone offset (format: +HH:MM or -HH:MM)
# Common offsets: +05:30 (IST), +00:00 (UTC), -05:00 (EST), +01:00 (CET)
MYSQL_TIMEZONE_OFFSET=+05:30

# =================================================================================
# DOCKER COMPOSE SETTINGS
# =================================================================================
# Container ports
RADIUS_AUTH_PORT=1812
RADIUS_ACCT_PORT=1813
MYSQL_PORT=3306
DASHBOARD_PORT=8080

# =================================================================================
# WEB DASHBOARD CONFIGURATION (Modern Dashboard - radius-gui)
# =================================================================================
# Application URL (used for links and redirects)
APP_URL=http://localhost:8080

# Application timezone (for display purposes)
APP_TIMEZONE=Asia/Kolkata

# Session security settings
SESSION_SECURE=false
SESSION_LIFETIME=7200

# Environment and debugging
APP_ENV=production
APP_DEBUG=false

# =================================================================================
# LEGACY DASHBOARD CONFIGURATION (DEPRECATED)
# =================================================================================
# These settings are for the old dashboard only (archive/dashboard-legacy/)
# The new dashboard (radius-gui) uses the operators table for authentication
#
# Admin dashboard credentials (CHANGE THESE!)
ADMIN_USERNAME=admin
ADMIN_PASSWORD=change_this_password_123
ADMIN_EMAIL=admin@yourdomain.com

# Dashboard security settings
JWT_SECRET=YourVerySecureJWTSecretKeyThatIsAtLeast32CharactersLong123!
SESSION_COOKIE_SECURE=false
FORCE_PASSWORD_CHANGE=true
ADMIN_SESSION_TIMEOUT=3600
BCRYPT_ROUNDS=12

# Domain configuration with VLAN assignments (JSON format)
# Configure all your Google Workspace domains here with their respective VLANs
#
# Key-based matching within a domain:
# - "key": Match this substring in the username before @ (e.g., ".mba" matches "john.mba@example.com")
# - Empty "key" ("") acts as the default/fallback for that domain
# - Entries are evaluated in order, first match wins
#
# Example 1: Key-based matching (single domain with different user types):
# DOMAIN_CONFIG=[{"domain":"students.example.com","key":".mba","Type":"Student-MBA","VLAN":"10"},{"domain":"students.example.com","key":".cs","Type":"Student-CS","VLAN":"20"},{"domain":"students.example.com","key":"","Type":"Student-Others","VLAN":"30"},{"domain":"staff.example.com","key":"","Type":"Staff","VLAN":"40"}]
#
# Example 2: Multiple domains (each domain gets one VLAN):
DOMAIN_CONFIG=[{"domain":"staff.yourdomain.com","key":"","Type":"Staff","VLAN":"10"},{"domain":"students.yourdomain.com","key":"","Type":"Student","VLAN":"20"},{"domain":"guests.yourdomain.com","key":"","Type":"Guest","VLAN":"30"}]

# =================================================================================
# VLAN ATTRIBUTE CONFIGURATION
# =================================================================================
# Configure which RADIUS attributes to use for VLAN assignment
# Comma-separated list of VLAN attributes to return in Access-Accept
#
# Standard VLAN Attributes (RFC 2868):
#   - Tunnel-Private-Group-ID (default, works with most vendors)
#
# Vendor-Specific Attributes:
#   - Aruba-User-VLAN (for Aruba/HPE controllers)
#   - Aruba-Named-User-VLAN (for Aruba with named VLANs)
#   - Cisco-AVPair (format: "vlan=XXX")
#
# Examples:
#   Standard only: VLAN_ATTRIBUTES=Tunnel-Private-Group-ID
#   Aruba only: VLAN_ATTRIBUTES=Aruba-User-VLAN
#   Multiple attributes: VLAN_ATTRIBUTES=Tunnel-Private-Group-ID,Aruba-User-VLAN,Aruba-Named-User-VLAN
#
# Note: The VLAN value from DOMAIN_CONFIG will be sent using all configured attributes
VLAN_ATTRIBUTES=Tunnel-Private-Group-ID

# =================================================================================
# ACCOUNTING REPLICATION TO FIREWALL/NAS
# =================================================================================
# Send accounting packets to firewall or external RADIUS server
# Set ENABLE_ACCT_REPLICATION=true to enable accounting packet forwarding
ENABLE_ACCT_REPLICATION=false

# Firewall/External RADIUS server IP address
FIREWALL_ACCT_SERVER=10.10.10.1

# Firewall RADIUS accounting port (usually 1813)
FIREWALL_ACCT_PORT=1813

# Shared secret for firewall RADIUS communication (CHANGE THIS!)
FIREWALL_ACCT_SECRET=your_firewall_radius_secret

# =================================================================================
# PERFORMANCE & LOGGING
# =================================================================================
# RADIUS Thread Pool Configuration
# Controls the maximum number of concurrent RADIUS worker threads
# OPTIMIZED: Automatically scales pool settings based on RADIUS_MAX_CONNECTIONS
# - start_servers: 10% of max (initial threads at startup)
# - max_servers: 100% (maximum concurrent threads)
# - min_spare_servers: 5% of max (minimum idle threads)
# - max_spare_servers: 20% of max (maximum idle threads)
#
# Recommended values:
#   - Small deployments (< 100 users): RADIUS_MAX_CONNECTIONS=50
#   - Medium deployments (100-1000 users): RADIUS_MAX_CONNECTIONS=150
#   - Large deployments (1000-3000 users): RADIUS_MAX_CONNECTIONS=500
#   - Enterprise (3000+ users): RADIUS_MAX_CONNECTIONS=1000
RADIUS_MAX_CONNECTIONS=500

# LDAP Connection Pool Configuration
# Controls the maximum number of LDAP connections to Google LDAP
# OPTIMIZED: Single LDAP pool serves ALL domains efficiently
# - start: 10% of max (initial connections at startup)
# - min: 10% of max (minimum connections to keep open)
# - max: 100% (maximum concurrent connections)
# - spare: 20% of max (idle connections ready for bursts)
#
# Recommended values:
#   - Small deployments (< 100 users): LDAP_MAX_CONNECTIONS=20
#   - Medium deployments (100-1000 users): LDAP_MAX_CONNECTIONS=50
#   - Large deployments (1000-3000 users): LDAP_MAX_CONNECTIONS=100
#   - Enterprise (3000+ users): LDAP_MAX_CONNECTIONS=200
#
# IMPORTANT: With single LDAP optimization, you need FAR FEWER connections
# Old multi-proxy setup: 4 domains × 100 connections = 400 total
# New single connection: 100 connections serves all domains!
LDAP_MAX_CONNECTIONS=100

# Logging configuration
LOG_LEVEL=info
ENABLE_LDAP_DEBUG=false

# =================================================================================
# DEBUG & SECURITY SETTINGS
# =================================================================================
# Set to 'true' to log usernames and passwords (DEVELOPMENT ONLY!)
# Set to 'false' for production (passwords will be masked in logs)
LOG_SENSITIVE_DATA=false
ENVIRONMENT=production

# =================================================================================
# LEGACY SETTINGS
# =================================================================================
# Legacy RADIUS secret (use SHARED_SECRET instead)
RADIUS_SECRET=YourSecureRadiusSecret123!

# Client network ranges (usually internal networks)
RADIUS_CLIENT_NETWORKS=10.0.0.0/8,172.16.0.0/12,192.168.0.0/16

# LDAP cache timeout in seconds (3000 = 50 minutes, recommended for performance)
CACHE_TIMEOUT=3000

# =================================================================================
# SECURITY NOTES
# =================================================================================
# BEFORE PRODUCTION DEPLOYMENT:
# 1. ✅ Change ALL default passwords (SHARED_SECRET, DB_PASSWORD, ADMIN_PASSWORD, etc.)
# 2. ✅ Update ACCESS_ALLOWED_CIDR to restrict access to your AP networks only
# 3. ✅ Place your Google LDAP certificates in the 'certs' directory:
#    - certs/ldap-client.crt (Google LDAP client certificate)
#    - certs/ldap-client.key (Google LDAP client private key - chmod 600)
# 4. ✅ Update BASE_DOMAIN and DOMAIN_EXTENSION to match your primary Google Workspace domain
# 5. ✅ Update LDAP_BASE_DN and LDAP_BIND_DN to match your domain structure
# 6. ✅ Update DOMAIN_CONFIG with all your Google Workspace domains and VLAN assignments
# 7. ✅ Update LDAP_IDENTITY and LDAP_PASSWORD with Google LDAP service account credentials
# 8. ✅ Set LOG_SENSITIVE_DATA=false for production
# 9. ✅ Set ENVIRONMENT=production
# 10. ✅ Enable HTTPS for dashboard in production (set SESSION_COOKIE_SECURE=true)
# 11. ✅ NEVER commit .env file to version control (it's in .gitignore)
#
# =================================================================================
# End of Configuration
# =================================================================================